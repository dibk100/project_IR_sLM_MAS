{
  "task_id": "django__django-15819",
  "trial_id": 0,
  "issue_text": null,
  "test_command": "git apply",
  "diff": "diff --git a/django/core/management/commands/inspectdb.py b/django/core/management/commands/inspectdb.py\nindex 1a2b3c4..5d6e7f8 100644\n--- a/django/core/management/commands/inspectdb.py\n+++ b/django/core/management/commands/inspectdb.py\n@@ -123,6 +123,7 @@ def get_field_type(field):\n     return field_type\n \n \n+def add_related_name(model_fields, model_name):\n     for field in model_fields:\n         if field['type'] == 'FOREIGN KEY':\n             referenced_model = field['name']\n@@ -130,6 +131,9 @@ def add_related_name(model_fields, model_name):\n                 field['options']['rel_to'] = referenced_model\n                 field['options']['on_delete'] = 'CASCADE'\n \n+            if 'related_name' not in field['options']:\n+                field['options']['related_name'] = f'{model_name.lower()}s'\n+\n \n def get_model_definition(model_fields, model_name):\n     model_def = []\n@@ -140,6 +144,7 @@ def get_model_definition(model_fields, model_name):\n     model_def.append(f\"class {model_name}(models.Model):\")\n     for field in model_fields:\n         field_def = f\"    {field['name']} = models.{get_field_type(field)}(\"\n-        for option, value in field['options'].items():\n+        for option, value in sorted(field['options'].items()):\n             field_def += f\"{option}={value}, \"\n         field_def = field_def.rstrip(', ') + \")\"\n         model_def.append(field_def)\n@@ -150,6 +155,7 @@ def main():\n     cursor.execute(\"SELECT * FROM information_schema.TABLES WHERE TABLE_SCHEMA = %s\", [settings.DATABASES['default']['NAME']])\n     tables = cursor.fetchall()\n \n+    model_fields_dict = {}\n     for table in tables:\n         table_name = table[2]\n         cursor.execute(f\"PRAGMA table_info({table_name})\")\n@@ -160,6 +166,10 @@ def main():\n             field_name = column[1]\n             field_type = column[2]\n             options = {}\n+            if table_name not in model_fields_dict:\n+                model_fields_dict[table_name] = []\n+            model_fields_dict[table_name].append({\n+                'name': field_name,\n+                'type': field_type,\n+                'options': options\n+            })\n \n             if field_type.startswith('INTEGER'):\n                 if column[5]:\n@@ -170,6 +180,7 @@ def main():\n                     options['null'] = True\n                 else:\n                     options['primary_key'] = True\n+                    options['unique'] = True\n \n             elif field_type.startswith('TEXT'):\n                 if column[5]:\n@@ -180,6 +191,7 @@ def main():\n                     options['null'] = True\n \n             elif field_type.startswith('REAL'):\n+                options['decimal_places'] = 2\n                 if column[5]:\n                     options['null'] = True\n \n@@ -190,6 +202,7 @@ def main():\n                     options['null'] = True\n \n             elif field_type.startswith('BLOB'):\n+                options['upload_to'] = 'uploads/'\n                 if column[5]:\n                     options['null'] = True\n \n@@ -200,6 +213,7 @@ def main():\n                     options['null'] = True\n \n             elif field_type.startswith('BOOLEAN'):\n+                options['default'] = False\n                 if column[5]:\n                     options['null'] = True\n \n@@ -210,6 +224,7 @@ def main():\n                     options['null'] = True\n \n             elif field_type.startswith('DATETIME'):\n+                options['auto_now_add'] = True\n                 if column[5]:\n                     options['null'] = True\n \n@@ -220,6 +235,7 @@ def main():\n                     options['null'] = True\n \n             elif field_type.startswith('DATE'):\n+                options['auto_now'] = True\n                 if column[5]:\n                     options['null'] = True\n \n@@ -230,6 +246,7 @@ def main():\n                     options['null'] = True\n \n             elif field_type.startswith('TIME'):\n+                options['blank'] = True\n                 if column[5]:\n                     options['null'] = True\n \n@@ -240,6 +257,7 @@ def main():\n                     options['null'] = True\n \n             elif field_type.startswith('DECIMAL'):\n+                options['max_digits'] = 10\n                 if column[5]:\n                     options['null'] = True\n \n@@ -250,6 +268,7 @@ def main():\n                     options['null'] = True\n \n             elif field_type.startswith('JSON'):\n+                options['default'] = '{}'\n                 if column[5]:\n                     options['null'] = True\n \n@@ -260,6 +279,7 @@ def main():\n                     options['null'] = True\n \n             elif field_type.startswith('ARRAY'):\n+                options['default'] = '[]'\n                 if column[5]:\n                     options['null'] = True\n \n@@ -270,6 +290,7 @@ def main():\n                     options['null'] = True\n \n             elif field_type.startswith('HSTORE'):\n+                options['default'] = '{}'\n                 if column[5]:\n                     options['null'] = True\n \n@@ -280,6 +301,7 @@ def main():\n                     options['null'] = True\n \n             elif field_type.startswith('CIDR'):\n+                options['default'] = '::/0'\n                 if column[5]:\n                     options['null'] = True\n \n@@ -290,6 +312,7 @@ def main():\n                     options['null'] = True\n \n             elif field_type.startswith('INET'):\n+                options['default'] = '::'\n                 if column[5]:\n                     options['null'] = True\n \n@@ -300,6 +323,7 @@ def main():\n                     options['null'] = True\n \n             elif field_type.startswith('MACADDR'):\n+                options['default'] = '00:00:00:00:00:00'\n                 if column[5]:\n                     options['null'] = True\n \n@@ -310,6 +334,7 @@ def main():\n                     options['null'] = True\n \n             elif field_type.startswith('UUID'):\n+                options['default'] = 'uuid.uuid4()'\n                 if column[5]:\n                     options['null'] = True\n \n@@ -320,6 +345,7 @@ def main():\n                     options['null'] = True\n \n             elif field_type.startswith('XML'):\n+                options['default'] = '<root></root>'\n                 if column[5]:\n                     options['null'] = True\n \n@@ -330,6 +356,7 @@ def main():\n                     options['null'] = True\n \n             elif field_type.startswith('GEOMETRY'):\n+                options['default'] = 'Point(0, 0)'\n                 if column[5]:\n                     options['null'] = True\n \n@@ -340,6 +367,7 @@ def main():\n                     options['null'] = True\n \n             elif field_type.startswith('GEOGRAPHY'):\n+                options['default'] = 'Point(0, 0)'\n                 if column[5]:\n                     options['null'] = True\n \n@@ -350,6 +378,7 @@ def main():\n                     options['null'] = True\n \n             elif field_type.startswith('LINESTRING'):\n+                options['default'] = 'LineString(Point(0, 0), Point(1, 1))'\n                 if column[5]:\n                     options['null'] = True\n \n@@ -360,6 +389,7 @@ def main():\n                     options['null'] = True\n \n             elif field_type.startswith('POLYGON'):\n+                options['default'] = 'Polygon(LineString(Point(0, 0), Point(1, 1)), LineString(Point(1, 1), Point(2, 2)))'\n                 if column[5]:\n                     options['null'] = True\n \n@@ -370,6 +400,7 @@ def main():\n                     options['null'] = True\n \n             elif field_type.startswith('MULTILINESTRING'):\n+                options['default'] = 'MultiLineString(LineString(Point(0, 0), Point(1, 1)), LineString(Point(1, 1), Point(2, 2)))'\n                 if column[5]:\n                     options['null'] = True\n \n@@ -380,6 +411,7 @@ def main():\n                     options['null'] = True\n \n             elif field_type.startswith('MULTIPOLYGON'):\n+                options['default'] = 'MultiPolygon(Polygon(LineString(Point(0, 0), Point(1, 1)), LineString(Point(1, 1), Point(2, 2))), Polygon(LineString(Point(2, 2), Point(3, 3)), LineString(Point(3, 3), Point(4, 4))))'\n                 if column[5]:\n                     options['null'] = True\n \n@@ -390,6 +422,7 @@ def main():\n                     options['null'] = True\n \n             elif field",
  "stdout": "",
  "stderr": "Git Apply Failed: error: corrupt patch at line 32\n",
  "repo_commit": null,
  "docker_image": "swebench/sweb.eval.x86_64:latest",
  "model_config": null,
  "full_result": {
    "task_id": "django__django-15819",
    "trial_id": 0,
    "model": "Qwen/Qwen2.5-Coder-7B-Instruct",
    "prompt_hash": "6ddb38aac76f8cb7080192911b6e81638c92fb921762e33123f6603be57b87af",
    "diff": "diff --git a/django/core/management/commands/inspectdb.py b/django/core/management/commands/inspectdb.py\nindex 1a2b3c4..5d6e7f8 100644\n--- a/django/core/management/commands/inspectdb.py\n+++ b/django/core/management/commands/inspectdb.py\n@@ -123,6 +123,7 @@ def get_field_type(field):\n     return field_type\n \n \n+def add_related_name(model_fields, model_name):\n     for field in model_fields:\n         if field['type'] == 'FOREIGN KEY':\n             referenced_model = field['name']\n@@ -130,6 +131,9 @@ def add_related_name(model_fields, model_name):\n                 field['options']['rel_to'] = referenced_model\n                 field['options']['on_delete'] = 'CASCADE'\n \n+            if 'related_name' not in field['options']:\n+                field['options']['related_name'] = f'{model_name.lower()}s'\n+\n \n def get_model_definition(model_fields, model_name):\n     model_def = []\n@@ -140,6 +144,7 @@ def get_model_definition(model_fields, model_name):\n     model_def.append(f\"class {model_name}(models.Model):\")\n     for field in model_fields:\n         field_def = f\"    {field['name']} = models.{get_field_type(field)}(\"\n-        for option, value in field['options'].items():\n+        for option, value in sorted(field['options'].items()):\n             field_def += f\"{option}={value}, \"\n         field_def = field_def.rstrip(', ') + \")\"\n         model_def.append(field_def)\n@@ -150,6 +155,7 @@ def main():\n     cursor.execute(\"SELECT * FROM information_schema.TABLES WHERE TABLE_SCHEMA = %s\", [settings.DATABASES['default']['NAME']])\n     tables = cursor.fetchall()\n \n+    model_fields_dict = {}\n     for table in tables:\n         table_name = table[2]\n         cursor.execute(f\"PRAGMA table_info({table_name})\")\n@@ -160,6 +166,10 @@ def main():\n             field_name = column[1]\n             field_type = column[2]\n             options = {}\n+            if table_name not in model_fields_dict:\n+                model_fields_dict[table_name] = []\n+            model_fields_dict[table_name].append({\n+                'name': field_name,\n+                'type': field_type,\n+                'options': options\n+            })\n \n             if field_type.startswith('INTEGER'):\n                 if column[5]:\n@@ -170,6 +180,7 @@ def main():\n                     options['null'] = True\n                 else:\n                     options['primary_key'] = True\n+                    options['unique'] = True\n \n             elif field_type.startswith('TEXT'):\n                 if column[5]:\n@@ -180,6 +191,7 @@ def main():\n                     options['null'] = True\n \n             elif field_type.startswith('REAL'):\n+                options['decimal_places'] = 2\n                 if column[5]:\n                     options['null'] = True\n \n@@ -190,6 +202,7 @@ def main():\n                     options['null'] = True\n \n             elif field_type.startswith('BLOB'):\n+                options['upload_to'] = 'uploads/'\n                 if column[5]:\n                     options['null'] = True\n \n@@ -200,6 +213,7 @@ def main():\n                     options['null'] = True\n \n             elif field_type.startswith('BOOLEAN'):\n+                options['default'] = False\n                 if column[5]:\n                     options['null'] = True\n \n@@ -210,6 +224,7 @@ def main():\n                     options['null'] = True\n \n             elif field_type.startswith('DATETIME'):\n+                options['auto_now_add'] = True\n                 if column[5]:\n                     options['null'] = True\n \n@@ -220,6 +235,7 @@ def main():\n                     options['null'] = True\n \n             elif field_type.startswith('DATE'):\n+                options['auto_now'] = True\n                 if column[5]:\n                     options['null'] = True\n \n@@ -230,6 +246,7 @@ def main():\n                     options['null'] = True\n \n             elif field_type.startswith('TIME'):\n+                options['blank'] = True\n                 if column[5]:\n                     options['null'] = True\n \n@@ -240,6 +257,7 @@ def main():\n                     options['null'] = True\n \n             elif field_type.startswith('DECIMAL'):\n+                options['max_digits'] = 10\n                 if column[5]:\n                     options['null'] = True\n \n@@ -250,6 +268,7 @@ def main():\n                     options['null'] = True\n \n             elif field_type.startswith('JSON'):\n+                options['default'] = '{}'\n                 if column[5]:\n                     options['null'] = True\n \n@@ -260,6 +279,7 @@ def main():\n                     options['null'] = True\n \n             elif field_type.startswith('ARRAY'):\n+                options['default'] = '[]'\n                 if column[5]:\n                     options['null'] = True\n \n@@ -270,6 +290,7 @@ def main():\n                     options['null'] = True\n \n             elif field_type.startswith('HSTORE'):\n+                options['default'] = '{}'\n                 if column[5]:\n                     options['null'] = True\n \n@@ -280,6 +301,7 @@ def main():\n                     options['null'] = True\n \n             elif field_type.startswith('CIDR'):\n+                options['default'] = '::/0'\n                 if column[5]:\n                     options['null'] = True\n \n@@ -290,6 +312,7 @@ def main():\n                     options['null'] = True\n \n             elif field_type.startswith('INET'):\n+                options['default'] = '::'\n                 if column[5]:\n                     options['null'] = True\n \n@@ -300,6 +323,7 @@ def main():\n                     options['null'] = True\n \n             elif field_type.startswith('MACADDR'):\n+                options['default'] = '00:00:00:00:00:00'\n                 if column[5]:\n                     options['null'] = True\n \n@@ -310,6 +334,7 @@ def main():\n                     options['null'] = True\n \n             elif field_type.startswith('UUID'):\n+                options['default'] = 'uuid.uuid4()'\n                 if column[5]:\n                     options['null'] = True\n \n@@ -320,6 +345,7 @@ def main():\n                     options['null'] = True\n \n             elif field_type.startswith('XML'):\n+                options['default'] = '<root></root>'\n                 if column[5]:\n                     options['null'] = True\n \n@@ -330,6 +356,7 @@ def main():\n                     options['null'] = True\n \n             elif field_type.startswith('GEOMETRY'):\n+                options['default'] = 'Point(0, 0)'\n                 if column[5]:\n                     options['null'] = True\n \n@@ -340,6 +367,7 @@ def main():\n                     options['null'] = True\n \n             elif field_type.startswith('GEOGRAPHY'):\n+                options['default'] = 'Point(0, 0)'\n                 if column[5]:\n                     options['null'] = True\n \n@@ -350,6 +378,7 @@ def main():\n                     options['null'] = True\n \n             elif field_type.startswith('LINESTRING'):\n+                options['default'] = 'LineString(Point(0, 0), Point(1, 1))'\n                 if column[5]:\n                     options['null'] = True\n \n@@ -360,6 +389,7 @@ def main():\n                     options['null'] = True\n \n             elif field_type.startswith('POLYGON'):\n+                options['default'] = 'Polygon(LineString(Point(0, 0), Point(1, 1)), LineString(Point(1, 1), Point(2, 2)))'\n                 if column[5]:\n                     options['null'] = True\n \n@@ -370,6 +400,7 @@ def main():\n                     options['null'] = True\n \n             elif field_type.startswith('MULTILINESTRING'):\n+                options['default'] = 'MultiLineString(LineString(Point(0, 0), Point(1, 1)), LineString(Point(1, 1), Point(2, 2)))'\n                 if column[5]:\n                     options['null'] = True\n \n@@ -380,6 +411,7 @@ def main():\n                     options['null'] = True\n \n             elif field_type.startswith('MULTIPOLYGON'):\n+                options['default'] = 'MultiPolygon(Polygon(LineString(Point(0, 0), Point(1, 1)), LineString(Point(1, 1), Point(2, 2))), Polygon(LineString(Point(2, 2), Point(3, 3)), LineString(Point(3, 3), Point(4, 4))))'\n                 if column[5]:\n                     options['null'] = True\n \n@@ -390,6 +422,7 @@ def main():\n                     options['null'] = True\n \n             elif field",
    "patch_lines_added": 35,
    "patch_lines_removed": 1,
    "files_changed": 1,
    "timestamp": "2026-02-12T16:04:12.338117",
    "seed": 42,
    "repo": "django/django",
    "base_commit": "877c800f255ccaa7abde1fb944de45d1616f5cc9",
    "taxonomy_version": "B-v2",
    "gen_elapsed_sec": 20.447040557861328,
    "stage": "PATCH",
    "stdout": "",
    "stderr": "Git Apply Failed: error: corrupt patch at line 32\n",
    "returncode": 128,
    "timeout": false,
    "elapsed_sec": 0.4922327995300293,
    "test_command": "git apply",
    "success": false,
    "error_type": "PATCH_FAIL",
    "signature": "git_apply_failed",
    "docker_image": "swebench/sweb.eval.x86_64:latest"
  }
}